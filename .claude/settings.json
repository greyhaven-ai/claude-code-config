{
  "permissions": {
    "allow": [
      "mcp__firecrawl-mcp__firecrawl_scrape"
    ],
    "deny": [],
    "ask": []
  },
  "hooks": {
    "PreToolUse": [
      {
        "name": "destructive-operation-validator",
        "description": "Prevents destructive operations without confirmation (Phase 1 - Critical Safety)",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "You are a safety validation expert evaluating tool usage for potential destructive operations.\n\nAnalyze this tool use request:\n\nTool: $ARGUMENTS.toolName\nArguments: $ARGUMENTS.arguments\nFile path: $ARGUMENTS.filePath (if applicable)\nCurrent working directory: $ARGUMENTS.cwd\n\nEvaluate for these HIGH RISK patterns:\n\n1. **Git Force Operations**\n   - git push --force, git push -f\n   - Especially to main/master branches\n   - Decision: BLOCK with confirmation request\n\n2. **File/Directory Deletion**\n   - rm -rf, rmdir on critical directories\n   - Deletion of .git, node_modules, dist, build (OK)\n   - Deletion of src/, config/, production files (BLOCK)\n   - Decision: BLOCK for critical dirs, APPROVE for build artifacts\n\n3. **Database Operations**\n   - DROP DATABASE, TRUNCATE, DELETE without WHERE\n   - Production database connections\n   - Decision: BLOCK on production, APPROVE on dev/test\n\n4. **Production Environment**\n   - Modifications to files containing 'production', 'prod', 'prd'\n   - Changes to .env.production, config/production.*\n   - Deployment scripts\n   - Decision: BLOCK with explicit confirmation\n\n5. **Security Files**\n   - Deletion or disabling of auth/security code\n   - Changes to .github/workflows (CI/CD)\n   - Modifications to Dockerfile, docker-compose.yml\n   - Decision: APPROVE but add WARNING\n\n**Response Format**:\n\nFor HIGH RISK (force push to main, production changes, destructive DB ops):\n{\n  \"decision\": \"block\",\n  \"reason\": \"Destructive operation detected: [specific operation]\",\n  \"systemMessage\": \"‚ö†Ô∏è DESTRUCTIVE OPERATION\\n\\n[Operation details]\\n\\nThis operation could cause data loss or production issues.\\n\\nIf this is intentional, please:\\n1. [Specific mitigation steps]\\n2. Confirm by re-running with explicit flag\\n\\nOr modify your approach to avoid this risk.\"\n}\n\nFor MEDIUM RISK (security file changes, deployment configs):\n{\n  \"decision\": \"approve\",\n  \"systemMessage\": \"‚ö†Ô∏è CAUTION: Modifying [security/deployment] files. Ensure changes are reviewed.\"\n}\n\nFor LOW RISK (normal operations, build artifact cleanup):\n{\n  \"decision\": \"approve\"\n}\n\nNow evaluate the provided tool use request and respond with JSON only.",
            "timeout": 25
          }
        ],
        "toolNames": ["Bash", "Write", "Edit", "MultiEdit"]
      },
      {
        "name": "security-file-protection",
        "description": "Protects security-critical files from unauthorized modification (Phase 1 - Critical Safety)",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "You are a security file protection expert. Evaluate if this file modification affects security.\n\nFile path: $ARGUMENTS.filePath\nOperation: $ARGUMENTS.toolName\nChange type: [analyze from context if available]\n\n**Security-Sensitive File Patterns**:\n\n1. **Authentication/Authorization**\n   - Patterns: **/auth*.{js,ts,py}, **/login*.{js,ts,py}, **/session*.{js,ts,py}\n   - Patterns: **/jwt*.{js,ts,py}, **/oauth*.{js,ts,py}, **/permission*.{js,ts,py}\n   - Risk: HIGH if disabling checks, MEDIUM if refactoring\n\n2. **Secrets/Configuration**\n   - Patterns: **/.env*, **/secrets*, **/credentials*, **/config/production*\n   - Patterns: **/keys/**, **/*.pem, **/*.key\n   - Risk: CRITICAL - should never be directly edited\n\n3. **Cryptography**\n   - Patterns: **/crypto*.{js,ts,py}, **/hash*.{js,ts,py}, **/encrypt*.{js,ts,py}\n   - Risk: HIGH if changing algorithms, MEDIUM if adding features\n\n4. **Infrastructure**\n   - Patterns: Dockerfile, docker-compose*.yml, **/*.k8s.yaml\n   - Patterns: .github/workflows/**, **/.circleci/**, **/.gitlab-ci.yml\n   - Risk: MEDIUM - changes affect deployment/security\n\n5. **Input Validation**\n   - Patterns: **/validation*.{js,ts,py}, **/sanitize*.{js,ts,py}\n   - Risk: HIGH if removing validation, LOW if adding\n\n**Decision Logic**:\n\nCRITICAL RISK (secrets, credentials):\n{\n  \"decision\": \"block\",\n  \"reason\": \"Direct modification of secrets/credentials file detected\",\n  \"systemMessage\": \"üîí SECURITY: Secrets files should not be directly edited.\\n\\nUse environment variables or secret management system instead.\\n\\nFile: [path]\\n\\nIf you must edit, use: vault edit [file]\"\n}\n\nHIGH RISK (disabling auth, weakening crypto):\n{\n  \"decision\": \"block\",\n  \"reason\": \"Security weakening detected in [file]\",\n  \"systemMessage\": \"üîí SECURITY REVIEW REQUIRED\\n\\nChange type: [DISABLING/WEAKENING]\\nFile: [path]\\n\\nThis modification appears to reduce security.\\nRequired: Security team review\\n\\nTo proceed:\\n1. Create security review ticket\\n2. Get approval from security team\\n3. Document justification\"\n}\n\nMEDIUM RISK (refactoring, infrastructure):\n{\n  \"decision\": \"approve\",\n  \"systemMessage\": \"‚ö†Ô∏è Security-sensitive file modified: [path]\\n\\nChange type: [REFACTORING/INFRASTRUCTURE]\\n\\nReminders:\\n- Run security tests before merge\\n- Request security team review in PR\\n- Update security documentation if needed\"\n}\n\nLOW RISK (strengthening, adding features):\n{\n  \"decision\": \"approve\",\n  \"systemMessage\": \"‚úÖ Security improvement detected in [path]. Good work!\"\n}\n\nNON-SECURITY (normal files):\n{\n  \"decision\": \"approve\"\n}\n\nCheck if the file path matches any security-sensitive patterns. Evaluate based on the pattern matching and respond with JSON only.",
            "timeout": 25
          }
        ],
        "toolNames": ["Write", "Edit", "MultiEdit"]
      }
    ]
  }
}
